{% extends 'base/base.html' %}
{% load static %}
{% block contenido %}
<!-- Earnings (Monthly) Card Example -->
<div class="card border-left-primary shadow h-100 py-2">
        <div class="card-body">
          <div class="row no-gutters align-items-center">
            <div class="col mr-2">
				<h1 class="page-header">
	              <small class="text-danger text-center">
	                {% if messages %}
	                {% for message in messages %}
	                {{ message|safe}}
	                {% endfor %}
	                {% endif %}
	              </small>
	            </h1>
              <h3 style="text-align: center;">DESPLAZAMIENTOS INTERNOS</h3>
              <div class="panel-heading">
                 <a href="{% url 'catalogos:producto_new_internos' %}" class="btn btn-info"><span class="fa fa-plus-circle"></span> Nueva</a>
                 <a href="{% url 'catalogos:categoria_print'%}" target="print" class="btn btn-info"><span class="fa fa-print"></span> Imprimir</a>


              </div>
              <br>
              <div class="h5 mb-0 font-weight-bold text-gray-800">
                <table width="100%" class="=table tabñe-striped table-bordered table-hover" id="dataTables-example">
                  <thead>
                      <tr>

              <th>Region</th>
              <th>Descripcion</th>
              <th>Cod Centro</th>
              <th>Centro Educativo</th>
              <th>Destino</th>
              <th>NNA</th>
              <th>PMTE</th>
              <th>CS</th>
              <th>TOTAL</th>
              <th>Ingresado</th>
			  <th>Validado</th>
              <th>Pendiente</th>
              <th>Creación</th>
			  <th>Acciones</th>
                      </tr>
                  </thead>
                  <tbody>
                      {% for item in obj %}
              <tr>

                  <th>{{ item.subcategoria}}</th>
                  <th>{{ item.identidadext}}</th>
                  <th>{{ item.codigoce}}</th>
                  <th>{{ item.centroeducativo}}</th>
                  <th>{{ item.destino}}</th>
                  <th>{{ item.NNA}}</th>
                  <th>{{ item.PMTE}}</th>
                  <th>{{ item.CS}}</th>
                  <th>{{ item.TOTAL}}</th>
				  <th>
					{% if item.estado == 1 %}
					<div class="custom-control custom-switch">
  						<input type="checkbox" class="custom-control-input" id="e{{item.id}}1" checked >
  						<label class="custom-control-label" for="e{{item.id}}1" active></label>
					</div>
					{% else %}
					<div class="custom-control custom-switch">
  						<input type="checkbox" class="custom-control-input" id="e{{item.id}}1"  >
  						<label class="custom-control-label" for="e{{item.id}}1" active></label>
					</div>
					{% endif %}
				  </th>
				  <th>
					{% if item.estado == 2 %}
					<div class="custom-control custom-switch">
  						<input type="checkbox" class="custom-control-input" id="e{{item.id}}2" checked >
  						<label class="custom-control-label" for="e{{item.id}}2" active></label>
					</div>
					{% else %}
					<div class="custom-control custom-switch">
  						<input type="checkbox" class="custom-control-input" id="e{{item.id}}2"  >
  						<label class="custom-control-label" for="e{{item.id}}2" active></label>
					</div>
					{% endif %}
				  </th>
				  <th>
					{% if item.estado == 3 %}
					<div class="custom-control custom-switch">
  						<input type="checkbox" class="custom-control-input" id="e{{item.id}}3" checked >
  						<label class="custom-control-label" for="e{{item.id}}3" active></label>
					</div>
					{% else %}
					<div class="custom-control custom-switch">
  						<input type="checkbox" class="custom-control-input" id="e{{item.id}}3"  >
  						<label class="custom-control-label" for="e{{item.id}}3" active></label>
					</div>
					{% endif %}
				  </th>
                  <td>{{ item.creado|date:'d/m/Y H:i' }}</td>
                  <td>
                    <a href="#" class="btn btn-primary btn-circle"><span class="fa fa-check"></span></a>
                    <a href="{% url 'catalogos:producto_edit_internos' item.id %}" class="btn btn-primary btn-circle"><span class="fa fa-edit"></span></a>
                    <a href="{% url 'catalogos:subcategoria_delete' item.id %}" class="btn btn-danger btn-circle"><span class="fa fa-trash"></span></a>
                  </td>
              </tr>
              {% endfor %}
                  </tbody>
              </table>

              </div>
            </div>

          </div>
        </div>
      </div>

<script src="{% static 'base/js/jquery.min.js' %}"></script>
<script src="{% static 'base/js/bootstrap.bundle.min.js' %}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootbox.js/4.4.0/bootbox.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<script type="text/javascript">
	function eliminar(datos){
		$.ajax({
            method: "POST",
            url: "{% url 'catalogos:modificar_internos' %}",
            data: {
                'elemento' : datos,
                'departamento_id': '{{Departamento}}',
                csrfmiddlewaretoken: '{{ csrf_token }}',
                }
            }).done(function (msg) {
                location.reload();
    		});
	}
	$(document).ready( function () {
	//	console.log('{{Lista}}');
	a = {{Lista}};
	ar = [];
	$.each(a, function( index, value ) {
  		//console.log( index + ": " + value );
        elemento = "#e" + value + 1;
		elemento2 = "#e" + value + 2;
		elemento3 = "#e" + value + 3;
		ar.push(elemento);
		ar.push(elemento2);
		ar.push(elemento3);
	});

	//console.log(ar)
   	$.each(ar, function( index, value ) {
  			$(value).change(
		      function(){
		        if ($(this).is(':checked')) {
					bootbox.confirm("¿Está seguro cambiar el estado?", function(result) {
        					if(result){
        						eliminar(value)
        					}else{
								alert('No quiere cambiar nada')
							}
							});
		            //console.log('Presionado' +  value);// do what you want here
		        }else{
					//console.log('Sin presionar');
				}
		    });
	});


	  $('#dataTables-example').DataTable(
				{
					responsive: true
				}
			);});
</script>
{% endblock contenido%}
